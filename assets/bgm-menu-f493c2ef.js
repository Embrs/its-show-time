import{d as k}from"./pinia-2ec0d1bb.js";import{u as _,b as O}from"./vue-router-3cbfdaf7.js";import{r as b,m as x}from"./@vue-68c6bb74.js";const P=r=>{try{return btoa(encodeURIComponent(r).replace(/%([0-9A-F]{2})/g,function(n,e){return String.fromCharCode(+("0x"+e))}))}catch{return""}},G=r=>{try{return decodeURIComponent(Array.prototype.map.call(atob(r.replace(/-| /g,"+").replace(/_/g,"/").replace(/%/g,"%25")),function(n){return"%"+n.charCodeAt(0).toString(16)}).join(""))}catch{return""}},d=!1,g={theme:"THEME",bmgKeepPage:"BGMKEEPPAGE",bgmCurrentPage:"BGMCURRENTPAGE"},I=(r,n)=>{try{const e=d?P(r):r,o=JSON.stringify(n),u=d?P(o):o;return e&&u?(localStorage.setItem(e,u),!0):!1}catch{return!1}},M=r=>{try{const n=d?P(r):r,e=localStorage.getItem(n)||"",o=d?G(e):e;return o?JSON.parse(o):void 0}catch{return}},C=r=>{try{const n=d?P(r):r;return n?(localStorage.removeItem(n),!0):!1}catch{return!1}},N=()=>{var u,l,m,f;let n=((u=_().options.routes.find(i=>i.path==="/bgm"))==null?void 0:u.children)??[];n=n.map(i=>({...i,key:i.path.replace("/bgm/","").split("/").pop()}));const e=n.reduce((i,p)=>({...i,[p.key]:p}),{}),o={home:{name:"儀表板",icon:"icon-globe"},editor:{name:"富文本",icon:"icon-doc-text-inv"},ds:{name:"系統設計",icon:"icon-sliders"},"theme-colors":{name:"主題色",icon:"icon-eyedropper"},"theme-fonts":{name:"字型",icon:"icon-font"},icons:{name:"Icon",icon:"icon-star-half-alt"},com:{name:"模組設計",icon:"icon-cubes"},dialog:{name:"彈窗與對話框",icon:"icon-chat"},aa:{name:"aa",icon:"icon-bug"},bb:{name:"bb",icon:"icon-bug"}};for(const i in o)o[i].path=((l=e==null?void 0:e[i])==null?void 0:l.path)||"",o[i].routeName=((f=(m=e==null?void 0:e[i])==null?void 0:m.name)==null?void 0:f.toString())||"";return{menuMap:o,bgmPages:n}},U=k("bgm-page-keep",()=>{const{menuMap:r}=N(),n=_(),e=b([]),o=b(""),u=()=>{I(g.bmgKeepPage,e.value),I(g.bgmCurrentPage,o.value)},l=()=>{e.value=M(g.bmgKeepPage)??[],o.value=M(g.bgmCurrentPage)??""},m=()=>{e.value=[],o.value="",C(g.bmgKeepPage),C(g.bgmCurrentPage)},f=t=>{if(!t)return;e.value.includes(t)||e.value.push(t);const a=r[t].path;a&&n.push(a),o.value=t,u()},i=t=>{e.value=t,u()},p=t=>{if(!t)return;const a=e.value.findIndex(c=>c===t);if(a!==-1){if(e.value.splice(a,1),o.value===t){const c=a-1>=0?a-1:a;o.value=e.value[c];const s=r[o.value].path;s&&n.push(s)}u()}},v=x(()=>e.value.map(t=>({...r[t],key:t})));return l(),{keepPages:e,currentPage:o,pageItemList:v,SelectPage:f,ChangePages:i,DeletePage:p,DeleteAll:m}}),D=k("bgm-menu",()=>{var p,v;const r=O(),{menuMap:n,bgmPages:e}=N(),o={};for(const t of e){const a=t.path.replace("/bgm/","").split("/");let c=o;for(const s of a)c[s]||(c[s]={routeName:"",path:"",key:s,name:((p=n[s])==null?void 0:p.name)||"",icon:((v=n[s])==null?void 0:v.icon)||"",childrenMap:{}},a[a.length-1]===s&&(c[s].path=t.path,c[s].routeName=t.name)),c=c[s].childrenMap}const u=b([]),l=b(),m=(t,a)=>{if(Object.keys(t).length!==0)for(const c in n){if(!t[c])continue;const{routeName:s,path:h,key:S,name:R,icon:A,childrenMap:E}=t[c],y={name:R,routeName:s,key:S,path:h,icon:A,children:[],isOpen:!1};!l.value&&h&&(l.value=y),m(E,y.children),a.push(y)}};m(o,u.value);const f=()=>{const t=a=>{for(const c of a)c.isOpen=!1,t(c.children)};t(u.value)};return{menuList:u,firstPage:l,OpenInit:(t="")=>{const a=t||r.path.replace("/bgm/","").split("/").pop();if(!a)return;f();const c=s=>{for(const h of s){const S=c(h.children);if(a===h.key||S)return h.isOpen=!0,!0}return!1};c(u.value)}}});export{D as a,U as u};
